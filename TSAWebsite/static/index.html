<!DOCTYPE html>
<html>
<head>
    <title>tsa thing</title>
</head>
<body>

<div id="buttons"></div>

<ul id="results"></ul>

<script>
async function loadButtons() {
    const res = await fetch("/tags");
    const tags = await res.json();
    const container = document.getElementById("buttons");

    for (const tagType in tags) {
        const h = document.createElement("h2");
        h.textContent = tagType;
        container.appendChild(h);

        tags[tagType].forEach(tagValue => {
            const btn = document.createElement("button");
            btn.textContent = tagValue;
            btn.onclick = () => loadPlaces(tagType, tagValue);
            container.appendChild(btn);
        });
    }
}

async function loadPlaces(tagType, tagValue) {
    const res = await fetch(`/places/${tagType}/${tagValue}`);
    const data = await res.json();

    const list = document.getElementById("results");
    list.innerHTML = "";

    if (!data.elements || data.elements.length === 0) {
        list.innerHTML = "<li>No results found</li>";
        return;
    }

    data.elements.forEach(el => {
        const name = el.tags?.name || "Unnamed place";
        const li = document.createElement("li");
        const a = document.createElement("a");

        a.href = `/place/${el.id}`;
        a.target = "_blank";
        a.textContent = name;

        li.appendChild(a);
        list.appendChild(li);
    });
}

loadButtons();
</script>

</body>
</html>